---
import { getCollection } from "astro:content";
import Container from "@components/Container.astro";
import PageLayout from "@layouts/PageLayout.astro";
import ArrowCard from "@components/ArrowCard.astro";
import Link from "@components/Link.astro";
import { SITE, HOME, SOCIALS } from "@consts";

// 1. Fetch Blog Posts
const blog = (await getCollection("blog"))
  .filter(post => !post.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, SITE.NUM_POSTS_ON_HOMEPAGE);

// 2. Fetch Photography Albums (New!)
const photography = (await getCollection("photography"))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, SITE.NUM_PHOTO_ALBUMS_ON_HOMEPAGE);
---

<PageLayout title={HOME.TITLE} description={HOME.DESCRIPTION}>
  <Container>
    
    <h4 class="animate font-semibold text-black dark:text-white">
      Hi, I'm Nicholas Drömert <span class="text-xl"></span> 
    </h4>
    <div class="space-y-16">
      <section>
        <article class="space-y-4">
          <p class="animate">
            Comparative Law Specialist & Web Developer based in Berlin.
          </p>
          <p class="animate">
            I have been extremely fortunate to benefit from a broad education in several different legal systems through my studies at The University of Birmingham, Freie Universität Berlin, and Tongji University Shanghai.
            Legal concepts love to travel around the world, but their implementation often tells you a great deal about local culture and history. 
            These stories and insights into different histories and cultures is what has made Comparative Law such a rewarding field for me. I continue, when I have time, to write a few short articles on subjects I find particulary interetsing which you can find in my blog. 
            Other intests of mind include photograhy - which I have sadly neglected recently - and the violin - which I am happy to say I get to play a great deal at the moment.
          </p>
        </article>
      </section>

      <section class="animate space-y-6">
        <div class="flex flex-wrap gap-y-2 items-center justify-between">
          <h5 class="font-semibold text-black dark:text-white">
            Latest posts
          </h5>
          <Link href="/blog">
            See all posts
          </Link>
        </div>
        <ul class="flex flex-col gap-4">
          {blog.map(post => (
            <li>
              <ArrowCard entry={post} />
            </li>
          ))}
        </ul>
      </section>

      <section class="animate space-y-6">
        <div class="flex flex-wrap gap-y-2 items-center justify-between">
          <h5 class="font-semibold text-black dark:text-white">
            Recent Photography
          </h5>
          <Link href="/photography">
            See all photos
          </Link>
        </div>
        <div class="grid grid-cols-2 gap-4">
          {photography.map(album => (
            <a href={`/photography/${album.slug}`} class="group relative block overflow-hidden rounded-lg bg-neutral-100 dark:bg-neutral-900 aspect-[4/3]">
              <img 
                src={album.data.cover} 
                alt={album.data.title}
                class="object-cover w-full h-full transition-transform duration-500 group-hover:scale-105 opacity-90 group-hover:opacity-100"
              />
              <div class="absolute inset-0 flex flex-col justify-end p-3 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                <span class="text-white text-sm font-medium">{album.data.title}</span>
              </div>
            </a>
          ))}
        </div>
      </section>

      <section class="animate space-y-4">
        <h5 class="font-semibold text-black dark:text-white">
          Let's Connect
        </h5>
        <ul class="flex flex-wrap gap-2">
          {SOCIALS.map(SOCIAL => (
            <li class="flex gap-x-2 text-nowrap">
              <Link href={SOCIAL.HREF} external aria-label={`${SITE.NAME} on ${SOCIAL.NAME}`}>
                {SOCIAL.NAME}
              </Link>
              {"/"}
            </li>
          ))}
          <li class="line-clamp-1">
            <Link href={`mailto:${SITE.EMAIL}`} aria-label={`Email ${SITE.NAME}`}>
              {SITE.EMAIL}
            </Link>
          </li>
        </ul>
      </section>

    </div>
  </Container>
</PageLayout>